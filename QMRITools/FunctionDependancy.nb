(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     49154,       1156]
NotebookOptionsPosition[     48584,       1139]
NotebookOutlinePosition[     48983,       1155]
CellTagsIndexPosition[     48940,       1152]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"<<", "QMRITools`"}]], "Input",
 CellChangeTimes->{3.796379604120758*^9},
 CellLabel->"In[86]:=",ExpressionUUID->"d1571e3c-2e04-4be1-980c-edbdf93b21c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"set", " ", "the", " ", "parameters"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"complexity", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"package", "=", "\"\<QMRITools\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"toolbox", "=", "\"\<SpectroTools\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"toolbox", "=", "\"\<*\>\""}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"get", " ", "my", " ", "functions"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"functions", "=", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Names", "[", 
        RowBox[{
        "package", "<>", "\"\<`\>\"", "<>", "toolbox", "<>", "\"\<`*\>\""}], 
        "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Attributes", "[", "#", "]"}], "==", 
         RowBox[{"{", 
          RowBox[{"Protected", ",", "ReadProtected"}], "}"}]}], "&"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"unprotect", " ", "all", " ", "my", " ", "functions"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ClearAtt", "[", "#", "]"}], "&"}], "[", "#", "]"}], "&"}], "/@",
      "functions"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"make", " ", "the", " ", "graphs"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"funcsGraphs", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"#", ",", 
          RowBox[{"SymbolDependencyGraph", "[", 
           RowBox[{"#", ",", "300", ",", 
            RowBox[{"VertexLabels", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"Placed", "[", 
               RowBox[{"\"\<Name\>\"", ",", "Tooltip"}], "]"}], "}"}]}], ",", 
            RowBox[{"VertexShapeFunction", "\[Rule]", "\"\<Square\>\""}], ",", 
            RowBox[{"VertexSize", "\[Rule]", "Medium"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"VertexStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"name_", "?", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringSplit", "[", 
                    RowBox[{"#", ",", "\"\<`\>\""}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "package"}], 
                    ")"}], "&"}], ")"}]}], "\[Rule]", 
                RowBox[{"{", "Red", "}"}]}], ",", 
               RowBox[{"{", "Blue", "}"}]}], "}"}]}], ",", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"600", ",", "600"}], "}"}]}], ",", " ", 
            RowBox[{"EdgeShapeFunction", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Gray", ",", "Thick", ",", 
                 RowBox[{"Line", "[", "#1", "]"}]}], "}"}], "&"}], ")"}]}]}], 
           "]"}]}], "}"}], "\[IndentingNewLine]", ")"}], "&"}], "/@", 
      "functions"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"protect", " ", "the", " ", "functions"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"SetAtt", "[", "#", "]"}], "&"}], "[", "#", "]"}], "&"}], "/@",
      "functions"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"graphsSel", "=", 
     RowBox[{"Reverse", "@", 
      RowBox[{"SortBy", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"funcsGraphs", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"VertexCount", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], ">", "complexity"}], 
           "&"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"VertexCount", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "&"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"list", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\< (\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"VertexCount", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<)\>\""}]}], ")"}], "&"}], "/@", "graphsSel"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", 
    RowBox[{"gr", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"gr", ",", 
         RowBox[{"list", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "\"\<Functions\>\""}], 
        "}"}], ",", "list"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.673942071429121*^9, 3.673942073987377*^9}, 
   3.6905383509320393`*^9, 3.6905383991518607`*^9, {3.7541410187161922`*^9, 
   3.7541410220617714`*^9}, {3.7963679291902733`*^9, 3.796367931823986*^9}, 
   3.7963679971923113`*^9, 3.7963680793570795`*^9, {3.796368113678184*^9, 
   3.796368117241538*^9}, {3.7963681553709426`*^9, 3.7963682148547883`*^9}, {
   3.796368248747777*^9, 3.7963682863581*^9}, {3.796368324102865*^9, 
   3.796368326905161*^9}, {3.796368393540637*^9, 3.796368404868248*^9}, {
   3.796368444177854*^9, 3.7963686246787043`*^9}, {3.7963777753364725`*^9, 
   3.796377778343652*^9}, {3.796377931291408*^9, 3.7963779335834713`*^9}, {
   3.796378069833619*^9, 3.7963780770471153`*^9}, {3.796378114087283*^9, 
   3.796378118815332*^9}, {3.796378307170193*^9, 3.796378310854863*^9}, {
   3.796378344939623*^9, 3.796378361479524*^9}, {3.796378513729814*^9, 
   3.7963785758023496`*^9}, {3.796378620463374*^9, 3.7963786231412544`*^9}, {
   3.7963786795363007`*^9, 3.79637870971218*^9}, {3.7963796008070016`*^9, 
   3.79637961263706*^9}, {3.796400558917953*^9, 3.796400776088566*^9}, {
   3.7964008831883926`*^9, 3.7964009385495434`*^9}, {3.796400981584632*^9, 
   3.7964010103535137`*^9}, {3.796401069820399*^9, 3.7964010701883736`*^9}, {
   3.7964011473888397`*^9, 3.7964011568737354`*^9}, {3.7964011931572733`*^9, 
   3.796401195910679*^9}, {3.796401234465259*^9, 
   3.79640129621618*^9}},ExpressionUUID->"750a2381-16ba-4599-8f95-\
6fa5e1d63e3f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Attributes", "[", "SymbolDependencyGraph", "]"}], " ", "=", " ", 
    RowBox[{"{", "HoldFirst", "}"}]}], ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymbolDependencyGraph", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", "name_String", ")"}], "?", "NameQ"}], ",", " ", 
      RowBox[{"limit_Integer", ":", "10"}], ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"NestGraph", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{"symName", ",", " ", 
         RowBox[{"DependentSymbols", "[", 
          RowBox[{"#1", ",", " ", 
           RowBox[{"\"\<ExcludedContexts\>\"", " ", "->", " ", 
            RowBox[{"OptionValue", "[", "\"\<ExcludedContexts\>\"", "]"}]}]}],
           "]"}], ",", " ", 
         RowBox[{"{", "1", "}"}]}], "]"}], " ", "&"}], " ", ",", " ", "name", 
      ",", " ", "limit", ",", " ", "opts"}], "]"}]}], ";"}], "\n", 
  " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymbolDependencyGraph", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", "sym_", ")"}], "?", "SymbolQ"}], ",", " ", 
      RowBox[{"limit_Integer", ":", "10"}], ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"name", " ", "=", " ", 
        RowBox[{"symName", "[", "sym", "]"}]}], "}"}], ",", " ", 
      RowBox[{"SymbolDependencyGraph", "[", 
       RowBox[{"name", ",", " ", "limit", ",", " ", "opts"}], "]"}]}], 
     "]"}]}], ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "SymbolDependencyGraph", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"AlignmentPoint", " ", "->", " ", "Center"}], ",", " ", 
      RowBox[{"AspectRatio", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"Axes", " ", "->", " ", "False"}], ",", " ", 
      RowBox[{"AxesLabel", " ", "->", " ", "None"}], ",", " ", 
      RowBox[{"AxesOrigin", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"AxesStyle", " ", "->", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"Background", " ", "->", " ", "None"}], ",", " ", 
      RowBox[{"BaselinePosition", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"BaseStyle", " ", "->", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"ContentSelectable", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"DirectedEdges", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"EdgeCapacity", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"EdgeCost", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"EdgeLabels", " ", "->", " ", "None"}], ",", " ", 
      RowBox[{"EdgeLabelStyle", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"EdgeShapeFunction", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"EdgeStyle", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"EdgeWeight", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"Editable", " ", "->", " ", "False"}], ",", " ", 
      RowBox[{"Epilog", " ", "->", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"FormatType", " ", "->", " ", "TraditionalForm"}], ",", " ", 
      RowBox[{"Frame", " ", "->", " ", "False"}], ",", " ", 
      RowBox[{"FrameLabel", " ", "->", " ", "None"}], ",", " ", 
      RowBox[{"FrameStyle", " ", "->", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"FrameTicks", " ", "->", " ", "None"}], ",", " ", 
      RowBox[{"FrameTicksStyle", " ", "->", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"GraphHighlight", " ", "->", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"GraphHighlightStyle", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"GraphLayout", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"GraphRoot", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"GraphStyle", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"GridLines", " ", "->", " ", "None"}], ",", " ", 
      RowBox[{"GridLinesStyle", " ", "->", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"ImageMargins", " ", "->", " ", "0."}], ",", " ", 
      RowBox[{"ImagePadding", " ", "->", " ", "All"}], ",", " ", 
      RowBox[{"ImageSize", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"LabelStyle", " ", "->", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"PerformanceGoal", " ", ":>", " ", "$PerformanceGoal"}], ",", 
      " ", 
      RowBox[{"PlotLabel", " ", "->", " ", "None"}], ",", " ", 
      RowBox[{"PlotRange", " ", "->", " ", "All"}], ",", " ", 
      RowBox[{"PlotRangeClipping", " ", "->", " ", "False"}], ",", " ", 
      RowBox[{"PlotRangePadding", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"PlotRegion", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"PlotTheme", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"Prolog", " ", "->", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"Properties", " ", "->", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"RotateLabel", " ", "->", " ", "True"}], ",", " ", 
      RowBox[{"Ticks", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"TicksStyle", " ", "->", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"VertexCapacity", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"VertexCoordinates", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"VertexLabels", " ", "->", " ", "None"}], ",", " ", 
      RowBox[{"VertexLabelStyle", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"VertexShape", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"VertexShapeFunction", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"VertexSize", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"VertexStyle", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"VertexWeight", " ", "->", " ", "Automatic"}], ",", " ", 
      RowBox[{"\"\<ExcludedContexts\>\"", " ", "->", " ", 
       RowBox[{"{", "\"\<System`\>\"", "}"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Attributes", "[", "symName", "]"}], " ", "=", " ", 
    RowBox[{"{", "HoldAllComplete", "}"}]}], ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"symName", "[", "s_", "]"}], " ", ":=", " ", 
   RowBox[{"ToString", "[", 
    RowBox[{"Unevaluated", "[", "s", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Attributes", "[", "DependentSymbols", "]"}], " ", "=", " ", 
    RowBox[{"{", "HoldAllComplete", "}"}]}], ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DependentSymbols", "[", 
     RowBox[{"str_String", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"ToExpression", "[", 
     RowBox[{"str", ",", " ", "StandardForm", ",", " ", 
      RowBox[{"Function", "[", 
       RowBox[{"s", ",", " ", 
        RowBox[{"DependentSymbols", "[", 
         RowBox[{"s", ",", " ", "opts"}], "]"}], ",", " ", 
        "HoldAllComplete"}], "]"}]}], "]"}]}], ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DependentSymbols", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", "sym_", ")"}], "?", "SymbolQ"}], ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"(*", 
        RowBox[{
        "stage1", ",", " ", "stage2", ",", " ", "stage3", ",", " ", "stage4", 
         ",", " ", "stage5", ",", " ", "excl", ",", " ", "symbols", ",", " ", 
         "symbols2"}], "*)"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"stage1", " ", "=", " ", 
        RowBox[{"joinInputDef", "[", 
         RowBox[{"Language`ExtendedDefinition", "[", "sym", "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"stage2", " ", "=", " ", 
        RowBox[{"List", " ", "@@", " ", 
         RowBox[{"Replace", "[", 
          RowBox[{"stage1", ",", " ", 
           RowBox[{
            RowBox[{"Language`DefinitionList", "[", 
             RowBox[{"_", " ", "->", " ", 
              RowBox[{"{", "defs___", "}"}]}], "]"}], " ", ":>", " ", 
            RowBox[{"parse1", " ", "/@", " ", 
             RowBox[{"TempHold", "[", "defs", "]"}]}]}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"stage3", " ", "=", " ", 
        RowBox[{"HoldComplete", " ", "@@", " ", 
         RowBox[{"(", 
          RowBox[{"stage2", " ", "//.", " ", 
           RowBox[{"p_parse2", " ", ":>", " ", 
            RowBox[{"TrEval", "[", "p", "]"}]}]}], ")"}]}]}], ";", " ", 
       RowBox[{"stage4", " ", "=", " ", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"stage3", " ", "//.", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", "f_", ")"}], "[", 
            RowBox[{"a___", ",", " ", 
             RowBox[{"TempHold", "[", "b___", "]"}], ",", " ", "c___"}], 
            "]"}], " ", ":>", " ", 
           RowBox[{"f", "[", 
            RowBox[{"a", ",", " ", "b", ",", " ", "c"}], "]"}]}]}], "]"}]}], 
       ";", " ", 
       RowBox[{"stage5", " ", "=", " ", 
        RowBox[{"Union", "[", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"TempHold", " ", "@@", " ", "stage4"}], ",", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"(", "s_", ")"}], "?", "SymbolQ"}], " ", ":>", " ", 
              RowBox[{"HoldComplete", "[", "s", "]"}]}], ",", " ", "Infinity",
              ",", " ", 
             RowBox[{"Heads", " ", "->", " ", "True"}]}], "]"}], ",", " ", 
           RowBox[{"HoldComplete", "[", "TempHold", "]"}]}], "]"}], "]"}]}], 
       ";", " ", 
       RowBox[{"symbols", " ", "=", " ", 
        RowBox[{"Cases", "[", 
         RowBox[{"stage5", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"HoldComplete", "[", 
             RowBox[{
              RowBox[{"(", "s_", ")"}], "?", "DefinedQ"}], "]"}], " ", "/;", 
            "  ", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"StringMatchQ", "[", 
               RowBox[{
                RowBox[{"SafeContext", "[", "s", "]"}], ",", " ", 
                RowBox[{
                "OptionValue", "[", "\"\<ExcludedContexts\>\"", "]"}]}], 
               "]"}]}], " ", "&&", " ", 
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"SafeContext", "[", "s", "]"}], ",", " ", 
               RowBox[{"OptionValue", "[", "\"\<Contexts\>\"", "]"}]}], 
              "]"}]}]}], " ", ":>", " ", 
           RowBox[{"HoldComplete", "[", "s", "]"}]}]}], "]"}]}], ";", " ", 
       RowBox[{"symbols2", " ", "=", " ", 
        RowBox[{"If", "[", " ", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"OptionValue", "[", "\"\<Self\>\"", "]"}]}], ",", " ", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"symbols", ",", " ", 
            RowBox[{"HoldComplete", "[", "sym", "]"}]}], "]"}], ",", " ", 
          "symbols"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"symbols2", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"symbols2", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"SyntaxInformation", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "=!=", 
              RowBox[{"{", "}"}]}], "&"}]}], "]"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<IgnoringUndefined\>\"", "]"}], ",", 
         " ", 
         RowBox[{"Cases", "[", 
          RowBox[{"symbols2", ",", " ", 
           RowBox[{"HoldComplete", "[", 
            RowBox[{
             RowBox[{"(", "s_", ")"}], "?", "DefinedQ"}], "]"}]}], "]"}], ",",
          " ", "symbols2"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}],
   "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DependentSymbols", "[", 
     RowBox[{"expr_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"$TempSymbol", " ", "=", " ", 
        RowBox[{"HoldComplete", "[", "expr", "]"}]}], "}"}], ",", " ", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"DependentSymbols", "[", 
         RowBox[{"$TempSymbol", ",", " ", "opts"}], "]"}], ",", " ", 
        RowBox[{"HoldComplete", "[", "$TempSymbol", "]"}]}], "]"}]}], "]"}]}],
    ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DependentSymbols", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", "sym_", ")"}], "?", "SymbolQ"}], ",", " ", "All", ",", 
      " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"getAll", "[", 
     RowBox[{"sym", ",", " ", "opts"}], "]"}]}], ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DependentSymbols", "[", 
     RowBox[{"expr_", ",", " ", "All", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"$TempSymbol", " ", "=", " ", 
        RowBox[{"HoldComplete", "[", "expr", "]"}]}], "}"}], ",", " ", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"DependentSymbols", "[", 
         RowBox[{"$TempSymbol", ",", " ", "All", ",", " ", "opts"}], "]"}], 
        ",", " ", 
        RowBox[{"HoldComplete", "[", "$TempSymbol", "]"}]}], "]"}]}], "]"}]}],
    ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "DependentSymbols", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Contexts\>\"", " ", "->", " ", "___"}], ",", " ", 
     RowBox[{"\"\<ExcludedContexts\>\"", " ", "->", " ", 
      RowBox[{
       RowBox[{
       "\"\<Algebra`\>\"", " ", "|", " ", "\"\<Algebraics`\>\"", " ", "|", 
        " ", "\"\<AlphaIntegration`\>\"", " ", "|", " ", 
        "\"\<Association`\>\"", " ", "|", " ", "\"\<Assumptions`\>\"", " ", 
        "|", " ", "\"\<AssumptionsDump`\>\"", " ", "|", " ", 
        "\"\<Asymptotics`\>\"", " ", "|", " ", "\"\<Audio`\>\"", " ", "|", 
        " ", "\"\<AugmentedData`\>\"", " ", "|", " ", 
        "\"\<Authentication`\>\"", " ", "|", " ", "\"\<BinningUtilities`\>\"",
         " ", "|", " ", "\"\<BooleanAlgebra`\>\"", " ", "|", " ", 
        "\"\<BoxForm`\>\"", " ", "|", " ", "\"\<BoxFormat`\>\"", " ", "|", 
        " ", "\"\<BrowserCategoryLoad`\>\"", " ", "|", " ", 
        "\"\<Calendar`\>\"", " ", "|", " ", "\"\<CCodeGenerator`\>\"", " ", 
        "|", " ", "\"\<CCompilerDriver`\>\"", " ", "|", " ", 
        "\"\<Charting`\>\"", " ", "|", " ", "\"\<CloudExpression`\>\"", " ", 
        "|", " ", "\"\<CloudObject`\>\"", " ", "|", " ", 
        "\"\<CloudSystem`\>\"", " ", "|", " ", "\"\<ClusterAnalysis`\>\"", 
        " ", "|", " ", "\"\<Compile`\>\"", " ", "|", " ", 
        "\"\<CompileDefinition`\>\"", " ", "|", " ", "\"\<Compiler`\>\"", " ",
         "|", " ", "\"\<ComplexAnalysis`\>\"", " ", "|", " ", 
        "\"\<ComputationalGeometry`\>\"", " ", "|", " ", 
        "\"\<Conditional`\>\"", " ", "|", " ", "\"\<Control`\>\"", " ", "|", 
        " ", "\"\<ControlSystems`\>\"", " ", "|", " ", "\"\<Conversion`\>\"", 
        " ", "|", " ", "\"\<Convert`\>\"", " ", "|", " ", 
        "\"\<CUDAInformation`\>\"", " ", "|", " ", "\"\<CURLLink`\>\"", " ", 
        "|", " ", "\"\<Data`\>\"", " ", "|", " ", "\"\<DatabaseLink`\>\"", 
        " ", "|", " ", "\"\<DataPaclets`\>\"", " ", "|", " ", 
        "\"\<Dataset`\>\"", " ", "|", " ", "\"\<DateAndTime`\>\"", " ", "|", 
        " ", "\"\<DateTime`\>\"", " ", "|", " ", "\"\<Debug`\>\"", " ", "|", 
        " ", "\"\<Debugger`\>\"", " ", "|", " ", "\"\<Deconvolve`\>\"", " ", 
        "|", " ", "\"\<Developer`\>\"", " ", "|", " ", 
        "\"\<DeviceFramework`\>\"", " ", "|", " ", "\"\<Devices`\>\"", " ", 
        "|", " ", "\"\<Discrete`\>\"", " ", "|", " ", "\"\<DiscreteMath`\>\"",
         " ", "|", " ", "\"\<Documentation`\>\"", " ", "|", " ", 
        "\"\<DocumentationSearch`\>\"", " ", "|", " ", "\"\<DragAndDrop`\>\"",
         " ", "|", " ", "\"\<DrawPolarAxes`\>\"", " ", "|", " ", 
        "\"\<DSolve`\>\"", " ", "|", " ", "\"\<DynamicDump`\>\"", " ", "|", 
        " ", "\"\<DynamicGeoGraphics`\>\"", " ", "|", " ", 
        "\"\<Embedded`\>\"", " ", "|", " ", "\"\<EntityFramework`\>\"", " ", 
        "|", " ", "\"\<EquationalLogic`\>\"", " ", "|", " ", 
        "\"\<EquationalProof`\>\"", " ", "|", " ", "\"\<Experimental`\>\"", 
        " ", "|", " ", "\"\<Explore`\>\"", " ", "|", " ", 
        "\"\<ExternalEvaluate`\>\"", " ", "|", " ", 
        "\"\<ExternalService`\>\"", " ", "|", " ", "\"\<Extras`\>\"", " ", 
        "|", " ", "\"\<Factor`\>\"", " ", "|", " ", "\"\<FE`\>\"", " ", "|", 
        " ", "\"\<FEPrivate`\>\"", " ", "|", " ", "\"\<FileFormatDump`\>\"", 
        " ", "|", " ", "\"\<Finance`\>\"", " ", "|", " ", 
        "\"\<FindMinimum`\>\"", " ", "|", " ", "\"\<FindRoot`\>\"", " ", "|", 
        " ", "\"\<FittedModels`\>\"", " ", "|", " ", "\"\<Format`\>\"", " ", 
        "|", " ", "\"\<FormulaData`\>\"", " ", "|", " ", "\"\<FrontEnd`\>\"", 
        " ", "|", " ", "\"\<GeneralUtilities`\>\"", " ", "|", " ", 
        "\"\<GenerateConditions`\>\"", " ", "|", " ", "\"\<GeoGraphics`\>\"", 
        " ", "|", " ", "\"\<GeometricFunctions`\>\"", " ", "|", " ", 
        "\"\<Geometry`\>\"", " ", "|", " ", "\"\<GIFTools`\>\"", " ", "|", 
        " ", "\"\<GIS`\>\"", " ", "|", " ", "\"\<GraphComputation`\>\"", " ", 
        "|", " ", "\"\<Graphics`\>\"", " ", "|", " ", 
        "\"\<GraphicsArray`\>\"", " ", "|", " ", "\"\<GroebnerBasis`\>\"", 
        " ", "|", " ", "\"\<GroebnerGCD`\>\"", " ", "|", " ", 
        "\"\<GroupTheory`\>\"", " ", "|", " ", 
        "\"\<HierarchicalClustering`\>\"", " ", "|", " ", 
        "\"\<Histogram`\>\"", " ", "|", " ", "\"\<Holonomic`\>\"", " ", "|", 
        " ", "\"\<HTTPHandling`\>\"", " ", "|", " ", 
        "\"\<HypergeometricLogDump`\>\"", " ", "|", " ", "\"\<Iconize`\>\"", 
        " ", "|", " ", "\"\<ILD`\>\"", " ", "|", " ", "\"\<Image`\>\"", " ", 
        "|", " ", "\"\<ImageAcquisition`\>\"", " ", "|", " ", 
        "\"\<ImageTransformation`\>\"", " ", "|", " ", "\"\<IMAPLink`\>\"", 
        " ", "|", " ", "\"\<IMAQ`\>\"", " ", "|", " ", 
        "\"\<ImportExport`\>\"", " ", "|", " ", "\"\<Inpaint`\>\"", " ", "|", 
        " ", "\"\<Integrate`\>\"", " ", "|", " ", 
        "\"\<IntegratedServices`\>\"", " ", "|", " ", "\"\<Internal`\>\"", 
        " ", "|", " ", "\"\<Interpreter`\>\"", " ", "|", " ", 
        "\"\<JLink`\>\"", " ", "|", " ", "\"\<JSONTools`\>\"", " ", "|", " ", 
        "\"\<Language`\>\"", " ", "|", " ", "\"\<Legending`\>\"", " ", "|", 
        " ", "\"\<LibraryLink`\>\"", " ", "|", " ", "\"\<Limit`\>\"", " ", 
        "|", " ", "\"\<LinearAlgebra`\>\"", " ", "|", " ", 
        "\"\<LocalObjects`\>\"", " ", "|", " ", "\"\<Manipulate`\>\"", " ", 
        "|", " ", "\"\<MarkovProcesses`\>\"", " ", "|", " ", 
        "\"\<MathLink`\>\"", " ", "|", " ", "\"\<MatrixFunction`\>\"", " ", 
        "|", " ", "\"\<MatrixLog`\>\"", " ", "|", " ", "\"\<MatrixPower`\>\"",
         " ", "|", " ", "\"\<MatrixSqrt`\>\"", " ", "|", " ", 
        "\"\<MediaTools`\>\"", " ", "|", " ", "\"\<MessageMenu`\>\"", " ", 
        "|", " ", "\"\<Method`\>\"", " ", "|", " ", "\"\<MLFS`\>\"", " ", "|",
         " ", "\"\<MobileMessaging`\>\"", " ", "|", " ", 
        "\"\<MultivariateResultant`\>\"", " ", "|", " ", "\"\<MUnit`\>\"", 
        " ", "|", " ", "\"\<NDSolve`\>\"", " ", "|", " ", "\"\<NETLink`\>\"", 
        " ", "|", " ", "\"\<Network`\>\"", " ", "|", " ", 
        "\"\<NeuralFunctions`\>\"", " ", "|", " ", "\"\<NeuralNetwork`\>\"", 
        " ", "|", " ", "\"\<NeuralNetworks`\>\"", " ", "|", " ", 
        "\"\<NIntegrate`\>\"", " ", "|", " ", "\"\<NMinimize`\>\"", " ", "|", 
        " ", "\"\<NotebookCompatibility`\>\"", " ", "|", " ", 
        "\"\<NotebookTemplating`\>\"", " ", "|", " ", 
        "\"\<NotebookTools`\>\"", " ", "|", " ", "\"\<NProduct`\>\"", " ", 
        "|", " ", "\"\<NRoots`\>\"", " ", "|", " ", "\"\<NSolve`\>\"", " ", 
        "|", " ", "\"\<NSum`\>\"", " ", "|", " ", "\"\<NumberNameDump`\>\"", 
        " ", "|", " ", "\"\<NumberTheory`\>\"", " ", "|", " ", 
        "\"\<NumericalMath`\>\"", " ", "|", " ", "\"\<OpenCLInformation`\>\"",
         " ", "|", " ", "\"\<Optimization`\>\"", " ", "|", " ", 
        "\"\<OutputSizeLimit`\>\"", " ", "|", " ", "\"\<Package`\>\"", " ", 
        "|", " ", "\"\<PacletManager`\>\"", " ", "|", " ", 
        "\"\<PacletTools`\>\"", " ", "|", " ", "\"\<Parallel`\>\"", " ", "|", 
        " ", "\"\<Periodic`\>\"", " ", "|", " ", 
        "\"\<PersistenceLocations`\>\"", " ", "|", " ", 
        "\"\<PlanetaryAstronomy`\>\"", " ", "|", " ", "\"\<Predictions`\>\"", 
        " ", "|", " ", "\"\<PredictiveInterface`\>\"", " ", "|", " ", 
        "\"\<Product`\>\"", " ", "|", " ", "\"\<Quantifier`\>\"", " ", "|", 
        " ", "\"\<QuantityArray`\>\"", " ", "|", " ", 
        "\"\<QuantityUnits`\>\"", " ", "|", " ", "\"\<Random`\>\"", " ", "|", 
        " ", "\"\<RandomProcesses`\>\"", " ", "|", " ", "\"\<RawArray`\>\"", 
        " ", "|", " ", "\"\<Reduce`\>\"", " ", "|", " ", "\"\<Region`\>\"", 
        " ", "|", " ", "\"\<RegularChains`\>\"", " ", "|", " ", 
        "\"\<Reliability`\>\"", " ", "|", " ", "\"\<ResourceLocator`\>\"", 
        " ", "|", " ", "\"\<ResourceSystemClient`\>\"", " ", "|", " ", 
        "\"\<RomanNumerals`\>\"", " ", "|", " ", "\"\<RootReduce`\>\"", " ", 
        "|", " ", "\"\<RootsDump`\>\"", " ", "|", " ", "\"\<RSolve`\>\"", " ",
         "|", " ", "\"\<RuntimeTools`\>\"", " ", "|", " ", 
        "\"\<Semantic`\>\"", " ", "|", " ", "\"\<Series`\>\"", " ", "|", " ", 
        "\"\<Services`\>\"", " ", "|", " ", "\"\<Signal`\>\"", " ", "|", " ", 
        "\"\<SimilarityScoreMatrices`\>\"", " ", "|", " ", 
        "\"\<Simplify`\>\"", " ", "|", " ", "\"\<Socket`\>\"", " ", "|", " ", 
        "\"\<Solve`\>\"", " ", "|", " ", "\"\<Sound`\>\"", " ", "|", " ", 
        "\"\<SparseArray`\>\"", " ", "|", " ", "\"\<SpecialFunctions`\>\"", 
        " ", "|", " ", "\"\<SpeechSynthesisTools`\>\"", " ", "|", " ", 
        "\"\<StartUp`\>\"", " ", "|", " ", "\"\<Statistics`\>\"", " ", "|", 
        " ", "\"\<StochasticCalculus`\>\"", " ", "|", " ", "\"\<Stream`\>\"", 
        " ", "|", " ", "\"\<Streaming`\>\"", " ", "|", " ", 
        "\"\<StringPattern`\>\"", " ", "|", " ", "\"\<StructuredArray`\>\"", 
        " ", "|", " ", "\"\<StructureDetection`\>\"", " ", "|", " ", 
        "\"\<StyleManager`\>\"", " ", "|", " ", "\"\<SubKernels`\>\"", " ", 
        "|", " ", "\"\<Sum`\>\"", " ", "|", " ", "\"\<SurfaceGraphics`\>\"", 
        " ", "|", " ", "\"\<SymbolicTensors`\>\"", " ", "|", " ", 
        "\"\<System`\>\"", " ", "|", " ", "\"\<SystemTools`\>\"", " ", "|", 
        " ", "\"\<Tasks`\>\"", " ", "|", " ", "\"\<Templating`\>\"", " ", "|",
         " ", "\"\<TemporalData`\>\"", " ", "|", " ", 
        "\"\<TextProcessing`\>\"", " ", "|", " ", "\"\<Themes`\>\"", " ", "|",
         " ", "\"\<Transforms`\>\"", " ", "|", " ", "\"\<Typeset`\>\"", " ", 
        "|", " ", "\"\<Utilities`\>\"", " ", "|", " ", "\"\<ValueTrack`\>\"", 
        " ", "|", " ", "\"\<Visualization`\>\"", " ", "|", " ", 
        "\"\<Wavelets`\>\"", " ", "|", " ", "\"\<WebServices`\>\"", " ", "|", 
        " ", "\"\<WolframAlphaClient`\>\"", " ", "|", " ", 
        "\"\<WolframBlockchain`\>\"", " ", "|", " ", "\"\<WSTP`\>\"", " ", 
        "|", " ", "\"\<XML`\>\"", " ", "|", " ", 
        "\"\<GeneralUtilities`\>\""}], "~~", "___"}]}], ",", " ", 
     RowBox[{"\"\<Self\>\"", " ", "->", " ", "False"}], ",", " ", 
     RowBox[{"\"\<IgnoringUndefined\>\"", " ", "->", " ", "True"}], ",", " ", 
     RowBox[{"\"\<IgnoreModuleSymbols\>\"", " ", "->", " ", "True"}]}], 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Attributes", "[", "SymbolQ", "]"}], " ", "=", " ", 
    RowBox[{"{", "HoldAllComplete", "}"}]}], ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymbolQ", "[", "s_Symbol", "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"Depth", "[", 
      RowBox[{"HoldComplete", "[", "s", "]"}], "]"}], " ", "===", " ", 
     "2"}]}], ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymbolQ", "[", "___", "]"}], " ", ":=", " ", "False"}], ";"}], 
  "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SymbolQ", "]"}], " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"joinInputDef", "[", 
     RowBox[{"Language`DefinitionList", "[", "]"}], "]"}], " ", ":=", " ", 
    RowBox[{"Language`DefinitionList", "[", "]"}]}], ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{"joinInputDef", "[", 
   RowBox[{"def", ":", 
    RowBox[{"Language`DefinitionList", "[", "_", "]"}]}], "]"}], " ", ":=", 
  " ", 
  RowBox[{"Quiet", "[", 
   RowBox[{"Check", "[", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "def2", "}"}], ",", " ", 
       RowBox[{
        RowBox[{"def2", " ", "=", " ", 
         RowBox[{"ToExpression", "[", 
          RowBox[{"ToString", "[", 
           RowBox[{"def", ",", " ", "InputForm"}], "]"}], "]"}]}], ";", " ", 
        RowBox[{"ReplacePart", "[", 
         RowBox[{"def", ",", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", " ", "2"}], "}"}], " ", "->", " ", 
           RowBox[{"Merge", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"def", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", " ", 
               RowBox[{"def2", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], ",", " ", 
             RowBox[{
             "DeleteDuplicates", " ", "@*", " ", "Flatten", " ", "@*", " ", 
              "Join"}]}], "]"}]}]}], "]"}]}]}], "]"}], ",", " ", "def"}], 
    "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Attributes", "[", "parse1", "]"}], " ", "=", " ", 
    RowBox[{"{", "HoldAllComplete", "}"}]}], ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"parse1", "[", 
     RowBox[{
      RowBox[{
      "OwnValues", " ", "|", " ", "SubValues", " ", "|", " ", "UpValues", " ",
        "|", " ", "DownValues", " ", "|", " ", "NValues", " ", "|", " ", 
       "FormatValues", " ", "|", " ", "DefaultValues", " ", "|", " ", 
       "Messages", " ", "|", " ", "Attributes"}], " ", "->", " ", 
      RowBox[{"{", "expr___", "}"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"parse2", " ", "/@", " ", 
     RowBox[{"TempHold", "[", "expr", "]"}]}]}], ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{"parse1", "[", 
   RowBox[{"OwnValues", " ", "->", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Verbatim", "[", "HoldPattern", "]"}], "[", "_", "]"}], " ", ":>",
      " ", "expr_"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"parse2", "[", "expr", "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Attributes", "[", "parse2", "]"}], " ", "=", " ", 
    RowBox[{"{", "HoldAllComplete", "}"}]}], ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"parse2", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Verbatim", "[", "HoldPattern", "]"}], "[", "lhs_", "]"}], " ",
       ":>", " ", "rhs_"}], "]"}], " ", ":=", " ", 
    RowBox[{"TempHold", "[", 
     RowBox[{"lhs", ",", " ", "rhs"}], "]"}]}], ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"parse2", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Verbatim", "[", "HoldPattern", "]"}], "[", "lhs_", "]"}], " ",
       "->", " ", "rhs_"}], "]"}], " ", ":=", " ", 
    RowBox[{"TempHold", "[", 
     RowBox[{"lhs", ",", " ", "rhs"}], "]"}]}], ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"parse2", "[", "expr___", "]"}], " ", ":=", " ", 
   RowBox[{"TempHold", "[", "expr", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Attributes", "[", "TempHold", "]"}], " ", "=", " ", 
    RowBox[{"{", "HoldAllComplete", "}"}]}], ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TempHold", "[", "th_TempHold", "]"}], " ", ":=", " ", "th"}], 
   ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "TempHold", "]"}], " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"HoldPattern", "[", 
    RowBox[{"swap_", " ", ":>", " ", 
     RowBox[{"TrEval", "[", "eval_", "]"}]}], "]"}], " ", "^:=", " ", 
   RowBox[{"swap", " ", ":>", " ", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"eval$", " ", "=", " ", "eval"}], "}"}], ",", " ", 
      RowBox[{"eval$", " ", "/;", " ", "True"}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Attributes", "[", "DefinedQ", "]"}], " ", "=", " ", 
    RowBox[{"{", "HoldAllComplete", "}"}]}], ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DefinedQ", "[", 
     RowBox[{
      RowBox[{"str_String", " ", "/;", " ", 
       RowBox[{
        RowBox[{"StringQ", "[", "str", "]"}], " ", "&&", " ", 
        RowBox[{"NameQ", "[", "str", "]"}]}]}], ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"ToExpression", "[", 
     RowBox[{"str", ",", " ", "StandardForm", ",", " ", 
      RowBox[{"Function", "[", 
       RowBox[{"s", ",", " ", 
        RowBox[{"DefinedQ", "[", 
         RowBox[{"s", ",", " ", "opts"}], "]"}], ",", " ", 
        RowBox[{"{", "HoldAllComplete", "}"}]}], "]"}]}], "]"}]}], ";"}], 
  "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DefinedQ", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", "symbol_", ")"}], "?", "SymbolQ"}], ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "ignore", "}"}], ",", " ", 
      RowBox[{
       RowBox[{"ignore", " ", "=", " ", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<Ignore\>\"", "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<Temporary\>\"", " ", "->", " ", "noTemporary"}], ",",
             " ", 
            RowBox[{
            "\"\<Undefined\>\"", " ", "->", " ", "ignoringAttributes"}], ",", 
            " ", 
            RowBox[{"_", " ", "->", " ", "Identity"}]}], "}"}]}], "]"}]}], 
       ";", "  ", 
       RowBox[{"!", 
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"ignore", "[", 
           RowBox[{"noVersionTag", "[", 
            RowBox[{"Language`ExtendedDefinition", "[", "symbol", "]"}], 
            "]"}], "]"}], ",", " ", 
          RowBox[{"Language`DefinitionList", "[", 
           RowBox[{
            RowBox[{"HoldForm", "[", "symbol", "]"}], " ", "->", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"OwnValues", " ", "->", " ", 
               RowBox[{"{", "}"}]}], ",", " ", 
              RowBox[{"SubValues", " ", "->", " ", 
               RowBox[{"{", "}"}]}], ",", " ", 
              RowBox[{"UpValues", " ", "->", " ", 
               RowBox[{"{", "}"}]}], ",", " ", 
              RowBox[{"DownValues", " ", "->", " ", 
               RowBox[{"{", "}"}]}], ",", " ", 
              RowBox[{"NValues", " ", "->", " ", 
               RowBox[{"{", "}"}]}], ",", " ", 
              RowBox[{"FormatValues", " ", "->", " ", 
               RowBox[{"{", "}"}]}], ",", " ", 
              RowBox[{"DefaultValues", " ", "->", " ", 
               RowBox[{"{", "}"}]}], ",", " ", 
              RowBox[{"Messages", " ", "->", " ", 
               RowBox[{"{", "}"}]}], ",", " ", 
              RowBox[{"Attributes", " ", "->", " ", 
               RowBox[{"{", "}"}]}]}], "}"}]}], "]"}]}], "]"}]}]}]}], "]"}]}],
    ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DefinedQ", "[", "___", "]"}], " ", ":=", " ", "False"}], ";"}], 
  "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "DefinedQ", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\"\<Ignore\>\"", " ", "->", " ", "\"\<Undefined\>\""}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"noTemporary", "[", 
     RowBox[{"Language`DefinitionList", "[", 
      RowBox[{"sym_", " ", "->", " ", 
       RowBox[{"{", 
        RowBox[{"defs___", ",", " ", 
         RowBox[{"Attributes", " ", "->", " ", 
          RowBox[{"{", 
           RowBox[{"a___", ",", " ", "Temporary", ",", " ", "b___"}], 
           "}"}]}]}], "}"}]}], "]"}], "]"}], " ", ":=", " ", 
    RowBox[{"Language`DefinitionList", "[", 
     RowBox[{"sym", " ", "->", " ", 
      RowBox[{"{", 
       RowBox[{"defs", ",", " ", 
        RowBox[{"Attributes", " ", "->", " ", 
         RowBox[{"{", 
          RowBox[{"a", ",", " ", "b"}], "}"}]}]}], "}"}]}], "]"}]}], ";"}], 
  "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"noTemporary", "[", "a___", "]"}], " ", ":=", " ", "a"}], ";"}], 
  "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "noTemporary", "]"}], " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ignoringAttributes", "[", 
     RowBox[{"Language`DefinitionList", "[", 
      RowBox[{"sym_", " ", "->", " ", 
       RowBox[{"{", 
        RowBox[{"defs___", ",", " ", 
         RowBox[{"Attributes", " ", "->", " ", "_"}]}], "}"}]}], "]"}], "]"}],
     " ", ":=", " ", 
    RowBox[{"Language`DefinitionList", "[", 
     RowBox[{"sym", " ", "->", " ", 
      RowBox[{"{", 
       RowBox[{"defs", ",", " ", 
        RowBox[{"Attributes", " ", "->", " ", 
         RowBox[{"{", "}"}]}]}], "}"}]}], "]"}]}], ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ignoringAttributes", "[", "a___", "]"}], " ", ":=", " ", "a"}], 
   ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ignoringAttributes", "]"}], " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"noVersionTag", "[", "defs_", "]"}], " ", ":=", " ", 
    RowBox[{"DeleteCases", "[", 
     RowBox[{"defs", ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Verbatim", "[", "HoldPattern", "]"}], "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", "version_", ")"}], "?", "SymbolQ"}], " ", "/;", " ", 
           RowBox[{
            RowBox[{"SymbolName", "[", 
             RowBox[{"Unevaluated", "[", "version", "]"}], "]"}], " ", "===", 
            " ", "\"\<Version\>\""}]}], ")"}], "[", "_", "]"}], "]"}], " ", "->",
        " ", "_String"}], ",", " ", "Infinity"}], "]"}]}], ";"}], "\n", 
  " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"noVersionTag", "[", "a___", "]"}], " ", ":=", " ", "a"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Attributes", "[", "SafeContext", "]"}], " ", "=", " ", 
    RowBox[{"{", "HoldAllComplete", "}"}]}], ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SafeContext", "[", 
     RowBox[{
      RowBox[{"(", "symbol_", ")"}], "?", "SymbolQ"}], "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"$Context", " ", "=", " ", "\"\<System`\>\""}], ",", " ", 
        RowBox[{"$ContextPath", " ", "=", " ", 
         RowBox[{"{", "\"\<System`\>\"", "}"}]}]}], "}"}], ",", " ", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"name", " ", "=", " ", 
          RowBox[{"StringTake", "[", 
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"HoldComplete", "[", "symbol", "]"}], ",", " ", 
              "InputForm", ",", " ", 
              RowBox[{
              "CharacterEncoding", " ", "->", " ", "\"\<ASCII\>\""}]}], "]"}],
             ",", " ", 
            RowBox[{"{", 
             RowBox[{"14", ",", " ", 
              RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], "}"}], ",", " ", 
        RowBox[{"Context", "[", "name", "]"}]}], "]"}]}], "]"}]}], ";"}], 
  "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SafeContext", "[", 
     RowBox[{
      RowBox[{"Verbatim", "[", "HoldPattern", "]"}], "[", 
      RowBox[{
       RowBox[{"(", "symbol_", ")"}], "?", "SymbolQ"}], "]"}], "]"}], " ", ":=",
     " ", 
    RowBox[{"SafeContext", "[", "symbol", "]"}]}], ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SafeContext", "[", 
     RowBox[{
      RowBox[{"Verbatim", "[", "Unevaluated", "]"}], "[", 
      RowBox[{
       RowBox[{"(", "symbol_", ")"}], "?", "SymbolQ"}], "]"}], "]"}], " ", ":=",
     " ", 
    RowBox[{"SafeContext", "[", "symbol", "]"}]}], ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SafeContext", "[", "string_String", "]"}], " ", ":=", " ", 
    RowBox[{"ToExpression", "[", 
     RowBox[{"string", ",", " ", "StandardForm", ",", " ", "SafeContext"}], 
     "]"}]}], ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SafeContext", "[", "a___", "]"}], " ", ":=", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"SafeContext", "::", "ssle"}], ",", " ", 
        RowBox[{"HoldForm", "[", 
         RowBox[{"SafeContext", "[", "a", "]"}], "]"}], ",", " ", "1"}], 
       "]"}], ";", " ", "$FailureContext"}], ")"}]}], ";"}], "\n", 
  " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SafeContext", "]"}], " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$FailureContext", " ", "=", " ", "\"\<$Failed`\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Attributes", "[", "getAll", "]"}], " ", "=", " ", 
    RowBox[{"{", "HoldFirst", "}"}]}], ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"getAll", "[", 
    RowBox[{"expr_", ",", " ", "opts___"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "keep", "}"}], ",", " ", 
     RowBox[{
      RowBox[{"keep", " ", "=", " ", 
       RowBox[{"Association", "[", "]"}]}], ";", " ", 
      RowBox[{
       RowBox[{"getMore", "[", 
        RowBox[{"keep", ",", " ", "opts"}], "]"}], "[", 
       RowBox[{"HoldComplete", "[", "expr", "]"}], "]"}], ";", " ", 
      RowBox[{"Keys", "[", "keep", "]"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Attributes", "[", "getMore", "]"}], " ", "=", " ", 
    RowBox[{"{", "HoldFirst", "}"}]}], ";"}], "\n", " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"getMore", "[", 
      RowBox[{"keep_", ",", " ", "opts___"}], "]"}], "[", 
     RowBox[{"HoldComplete", "[", "expr_", "]"}], "]"}], " ", ":=", " ", 
    RowBox[{"If", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"!", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"keep", ",", " ", 
          RowBox[{"HoldComplete", "[", "expr", "]"}]}], "]"}]}], " ", "&&", 
       " ", 
       RowBox[{"DefinedQ", "[", "expr", "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"keep", "[", 
         RowBox[{"HoldComplete", "[", "expr", "]"}], "]"}], " ", "=", " ", 
        "True"}], ";", " ", 
       RowBox[{
        RowBox[{"getMore", "[", 
         RowBox[{"keep", ",", " ", "opts"}], "]"}], " ", "/@", " ", 
        RowBox[{"DependentSymbols", "[", 
         RowBox[{"expr", ",", " ", "opts"}], "]"}]}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAtt", "=", 
    RowBox[{
     RowBox[{"ClearAttributes", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", "#1", "]"}], ",", 
       RowBox[{"{", "ReadProtected", "}"}]}], "]"}], "&"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAtt", "=", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{
      RowBox[{"Evaluate", "[", "#1", "]"}], ",", 
      RowBox[{"{", "ReadProtected", "}"}]}], "]"}], "&"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7963672529077873`*^9, 3.7963673624259224`*^9}, {
  3.7963674688740683`*^9, 3.7963674765664215`*^9}, {3.796367510503157*^9, 
  3.796367527785177*^9}, {3.79637769078224*^9, 3.7963777134913535`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"82ba3a60-8872-44d9-9fae-cd04dea3c693"]
},
WindowSize->{1081, 1135},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (March 14, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"176aa98d-91ee-4255-8b28-e5e87c8c2c63"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 175, 3, 28, "Input",ExpressionUUID->"d1571e3c-2e04-4be1-980c-edbdf93b21c8"],
Cell[736, 25, 6727, 165, 485, "Input",ExpressionUUID->"750a2381-16ba-4599-8f95-6fa5e1d63e3f"],
Cell[7466, 192, 41114, 945, 3519, "Input",ExpressionUUID->"82ba3a60-8872-44d9-9fae-cd04dea3c693",
 InitializationCell->True]
}
]
*)

